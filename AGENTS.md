# Agent Instructions

このリポジトリを扱う際の指示。

## 利用可能なプロンプト

`prompts/` ディレクトリに、特定のタスクを実行するためのプロンプトがある。

| プロンプト | 目的 | 使い方 |
|-----------|------|--------|
| `explain-all.md` | 全ファイルを網羅的に説明 | 対象リポジトリで読み込んで実行 |
| `import-from-fdp.md` | 参照リポジトリを参考にパターンを再実装 | プロジェクトに取り込む際に使用 |
| `export-to-fdp.md` | FDPへ同期（公開用） | 公開対象を同期する際に使用 |

### 使用例

```
prompts/explain-all.md を読んで、examples/<project>/ の全ファイルを説明してください
```

```
prompts/import-from-fdp.md を読んで、worktree保護のパターンを再実装してください
```

## 長いプロンプト実行時のCompact対策

100行以上のプロンプトを実行する際は、コンテキスト圧縮でルールが失われる可能性がある。以下を守ること：

### 1. 作業開始時
- プロンプトの「重要ルール」「禁止事項」をTodoリストに登録する
- 中間ファイル（tmp/等）にルールサマリーを保存する

### 2. Subagent起動時
プロンプトの重要ルールを指示に含める：
```
「{プロンプトファイル} を読んで {タスク} を実行。
重要ルール: {プロンプトから抽出}」
```

### 3. 各ステップ完了後
検証コマンドがプロンプトに記載されている場合は必ず実行する。
NGなら修正してから次へ進む。

### 4. Compact発生後
実行中のプロンプトファイルを再度Readしてから作業を継続する。
