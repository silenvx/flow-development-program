# 参照リポジトリからのインポート

FDP（Flow Development Program）または任意の参照リポジトリを参考にして、プロジェクトに必要な機能を**再実装**する。

---

## 使い方

このpromptは**目的ベース**で使用する：

```
prompts/import-from-fdp.md を読んで、worktree保護機能を実装してください
```

```
prompts/import-from-fdp.md を読んで、PRマージ前のチェック機能を実装してください
```

**目的なしで使用しないこと**。「とりあえずFDPを参考にして」では何も実装できない。

---

## 重要: コピーではなく再実装

FDPはコピー元ではなく**参考**として使用する。

| 禁止 | 推奨 |
|------|------|
| コードをそのままコピー | パターンを理解して再実装 |
| ファイルを丸ごと取り込む | 必要な機能を独自に実装 |

**理由**:
- **セキュリティ**: 外部コードは内容を理解してから使用
- **適応**: プロジェクト固有の要件に最適化

---

## 前提

**参照ソースは `generated/explain-all/<source>/` を使用する。**

- `<source>` は参照リポジトリ名（例: `fdp`, `project-a`）
- このディレクトリが未生成の場合は、先に `prompts/explain-all.md` を実行して生成する

> 将来的に軽量インデックスへ置き換える設計は可能だが、現時点では `generated/explain-all/` を前提とする

---

## 実行手順

### 1. 目的を明確化

- 何を実現したいか（1〜2文で記述）
- 既存の仕組みと衝突しそうな点（あれば）

### 2. 参照ソースを選択

- FDPを参照するか、別リポジトリを参照するかを決める
- 参照ソースの `generated/explain-all/<source>/` を対象にする

### 3. 参照ソースで関連パターンを検索

ユーザーが指定した目的に関連するファイルを探す：

```bash
# explain-allの説明ファイルを検索
rg "worktree" generated/explain-all/<source>/ -n
```

### 4. パターンを理解

見つかったファイルについて以下を把握：

| 情報 | 確認方法 |
|------|----------|
| 目的（Why） | explain-allのWhy列 |
| 機能（What） | explain-allのWhat列 |
| 実行タイミング | explain-allの使い方列や設定説明 |
| 依存 | explain-allの記載（なければ推測ではなく明示的に不明とする） |

### 5. プロジェクトの要件を確認

- 使用言語・フレームワーク
- 既存の `.claude/` 構成
- プロジェクト固有の制約

### 6. 再実装

参照パターンを参考に、プロジェクトに適した実装を作成：

1. FDPのdocstringで目的（Why/What）を把握
2. 実装アプローチを理解
3. プロジェクトの要件に合わせて再設計
4. 独自のコードとして実装
5. テストで動作確認
6. settings.jsonにフックを登録

**禁止**: 参照リポジトリのコードをそのままコピーすること。

### 7. 検証

- 成功ケース / 失敗ケース / 境界ケースを最低限確認
- 自動テストがある場合は追加、なければ手順を記載

## docstring規約

実装するフックには以下の形式を推奨：

```python
"""<1行の説明>

Why:
    <なぜ必要か>

What:
    <何をするか>
"""
```

---

## 参照先で見つかる主なパターン

| カテゴリ | 検索キーワード例 |
|----------|-----------------|
| Worktree保護 | `worktree`, `session-guard`, `locked` |
| PRマージチェック | `merge-check`, `review`, `closes` |
| Issue管理 | `issue`, `assign`, `priority` |
| セッション管理 | `session`, `handoff`, `continuation` |
| 振り返り | `reflection`, `gosei`, `lesson` |
| CI監視 | `ci-monitor`, `checks`, `behind` |
| コード品質 | `lint`, `test`, `coverage` |

---

## 出力

実装完了後、以下を報告：

1. 実装したファイル一覧
2. settings.jsonへの登録内容
3. 動作確認結果
4. 参照元（`<source>`）と参照ファイル
