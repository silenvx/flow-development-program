# PR/Issue評価と五省

PR/Issue実装評価と開発フローの五省評価。

## 3. PR/Issue実装評価（必須）

**重要**: セッション中に作成したPR/Issueの**実装内容**を評価します。

### 3.1 Issue要件の抽出（最初に実行）

```bash
# Issue本文を読む（必須）
gh issue view <Issue番号>
```

**抽出すべき項目**:

| 抽出項目 | 確認内容 |
|---------|---------|
| **明示的要件** | Issue本文に書かれた要件 |
| **チェックリスト** | `- [ ]` 形式のタスク一覧 |
| **対応案** | 「対応案」セクションに書かれた実装方針 |
| **暗黙の要件** | 明示されていないが当然必要な事項 |

### 3.2 PR実装内容の確認

```bash
# PRの説明を読む
gh pr view <PR番号>

# 変更ファイル一覧
gh pr view <PR番号> --json files --jq '.files[].path'
```

### 3.3 要件と実装の突合せ（核心）

| Issue要件 | PR実装 | 状態 |
|----------|--------|------|
| 例: ブロック型に変更 | 実装済み | 完了 |
| 例: エッジケース対応 | 未実装 | **要対応** |

### 3.4 レビューコメントの確認

```bash
# コードレビューコメント
gh api repos/:owner/:repo/pulls/<PR番号>/comments --jq '.[] | {path: .path, body: .body}'

# 会話コメント
gh pr view <PR番号> --json comments --jq '.comments[] | {author: .author.login, body: .body}'
```

### 3.5 Dogfooding詳細チェック

**重要**: 作業種別に応じたDogfoodingを実施したか確認する。

| 作業種別 | 確認内容 | チェック |
|---------|---------|---------|
| **フック修正** | そのセッション内でフックがトリガーされたか | [ ] |
| **観点追加（reflection_self_check）** | その振り返りで新観点のキーワードを使用したか | [ ] |
| **スクリプト修正** | 修正したスクリプトを、実際の開発フローの中で利用したか | [ ] |
| **Plan mode関連** | plan modeを使用して実際の動作を確認したか（EnterPlanModeで計画作成→承認フローまで） | [ ] |
| **CI/監視ツール** | 実際のPRで動作確認したか | [ ] |
| **ドキュメント追加** | **追加したドキュメント/表を、その後のセッション（特にこの振り返り）で実際に参照・使用したか** | [ ] |

**ドキュメント追加時の注意**:
- 作成時に1回実行するだけでは不十分
- **その後のセッション（特に振り返り）で継続的に参照・使用**することが重要
- 「以降のセッションで表/ガイドを参照して使用」まで含めてDogfooding

### 3.6 動作確認Issue検証（必須）

オープンな動作確認Issueを一括検証する。

```bash
bun run .claude/scripts/observation_verifier_ts/main.ts --execute
```

- 自動クローズされたissueを記録
- 人間確認項目のみ残るissueはスキップ（報告のみ）
- 検証失敗のissueは原因を調査

### 3.7 観点チェック

| 観点 | 確認内容 | チェック |
|------|----------|---------|
| **実装後の動作確認** | マージ後に動作を確認したか | [ ] |
| **Dogfooding** | 作業種別に応じたDogfoodingを実施したか（上記3.5参照） | [ ] |

## 4. 開発フローの評価（五省）

五省に基づき自己評価してください：

### 五省（AIエージェント版）

1. **要件理解に悖（もと）るなかりしか**
   - ユーザーの要求を正確に理解したか
   - 曖昧な点を確認せず進めなかったか

2. **実装に恥づるなかりしか**
   - コード品質は十分か
   - テスト・ドキュメントは適切に追加したか

3. **検証に欠くるなかりしか**
   - ビルド・テスト・Lintを確認したか
   - レビューコメントを見落としていないか

4. **対応に憾みなかりしか**
   - レビュー指摘を慎重に評価したか
   - 全てに対応したか

5. **効率に欠くるなかりしか**
   - 無駄な作業はなかったか
   - 並列実行・sub-agentを活用したか

### 振り返り出力テンプレート

```markdown
## セッション概要

- **日時**: YYYY-MM-DD HH:MM - HH:MM
- **セッションID**: [.claude-sessionから取得]
- **成果物**: PR #XXX, Issue #XXX（マージ済み/オープン）

## 今回のセッションで行った作業

1. [作業1の説明] (PR/Issue番号)
2. [作業2の説明] (PR/Issue番号)

## 五省

1. **要件理解に悖るなかりしか**
   - [具体的な評価内容]
   - **反省点**: [あれば記載]

2. **実装に恥づるなかりしか**
   - [具体的な評価内容]
   - **反省点**: [あれば記載]

3. **検証に欠くるなかりしか**
   - [ビルド/テスト/Lint結果]
   - [AIレビュー結果]

4. **対応に憾みなかりしか**
   - [レビューコメント対応状況]

5. **効率に欠くるなかりしか**
   - [ワークフロー評価]
   - **反省点**: [あれば記載]

## 反省点と対策

| 反省点 | 対策 | 優先度 | Issue（あれば） |
|--------|------|--------|----------------|
| [具体的な反省点] | [仕組み化/ドキュメント化] | 高/中/低 | [あればIssue番号] |
```
