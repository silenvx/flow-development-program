# Progressive Disclosure ガイド

SKILL.mdが500行を超えた場合の分割戦略。

---

## なぜ分割が必要か

| 問題 | 影響 |
|------|------|
| コンテキストウィンドウ圧迫 | 会話履歴や他Skillsと競合 |
| Attention分散 | 重要な情報が埋もれる |
| ロード時間増加 | 不要な情報もロードされる |

**目標**: 必要な情報のみを必要な時にロードする。

---

## 分割の閾値

| 行数 | 判定 | 対応 |
|------|------|------|
| ~500行 | ✅ 適正 | そのまま |
| 500-1000行 | ⚠️ 要検討 | 分割を検討 |
| 1000行超 | ❌ 分割必須 | 即座に分割 |

---

## 分割パターン

### パターン1: ドメイン別分割

機能ドメインごとにファイルを分ける。

```
my-skill/
├── SKILL.md (概要 + ナビゲーション、~200行)
├── setup.md (セットアップ手順)
├── workflows.md (ワークフロー)
├── templates.md (テンプレート集)
└── troubleshooting.md (トラブルシューティング)
```

### パターン2: 段階別分割

学習段階に応じて分ける。

```
my-skill/
├── SKILL.md (概要 + クイックスタート、~200行)
├── basics.md (基本操作)
├── advanced.md (高度な操作)
└── reference.md (リファレンス)
```

### パターン3: ユースケース別分割

ユースケースごとに分ける。

```
my-skill/
├── SKILL.md (概要 + ユースケース一覧、~200行)
├── usecase-create.md (作成ユースケース)
├── usecase-update.md (更新ユースケース)
└── usecase-delete.md (削除ユースケース)
```

---

## 目次パターン（親ファイルに記載）

分割したファイルを探索可能にするため、親ファイルに目次を記載する。

### テーブル形式（推奨）

```markdown
## 詳細ガイド

| トピック | ファイル | 内容 |
|----------|----------|------|
| セットアップ | [setup.md](setup.md) | 環境構築、初期設定 |
| ワークフロー | [workflows.md](workflows.md) | 作業手順、フロー図 |
| テンプレート | [templates.md](templates.md) | コピペ用テンプレート |
| トラブルシューティング | [troubleshooting.md](troubleshooting.md) | よくある問題と解決策 |
```

### リスト形式

```markdown
## 詳細ガイド

- [セットアップ](setup.md) - 環境構築、初期設定
- [ワークフロー](workflows.md) - 作業手順、フロー図
- [テンプレート](templates.md) - コピペ用テンプレート
- [トラブルシューティング](troubleshooting.md) - よくある問題と解決策
```

---

## 参照ルール

### 1レベル参照のみ

深いネストを避ける。

```
# ✅ Good: 1レベル
SKILL.md → workflows.md

# ❌ Bad: 2レベル以上
SKILL.md → workflows.md → advanced-workflows.md
```

### 循環参照禁止

```
# ❌ Bad: 循環
SKILL.md → setup.md → SKILL.md
```

---

## 分割チェックリスト

分割時に確認:

- [ ] 親ファイル（SKILL.md）に目次を追加したか
- [ ] 各分割ファイルに「親ファイルに戻る」リンクを追加したか
- [ ] 参照は1レベルに収まっているか
- [ ] 循環参照がないか
- [ ] 分割後の各ファイルが500行以下か

---

## 分割後のテスト

分割後に以下を確認:

1. **探索テスト**: 「〜について教えて」で適切なファイルが参照されるか
2. **ナビゲーションテスト**: 目次から各ファイルに遷移できるか
3. **コンテキストテスト**: 必要な情報のみロードされているか（不要なファイルがロードされていないか）

---

## 既存Skillの分割例

### hooks-reference（1652行 → ~300行×5）

```
hooks-reference/
├── SKILL.md (概要 + ナビゲーション、~300行)
├── templates.md (フックテンプレート)
├── patterns.md (実装パターン)
├── checklist.md (チェックリスト)
└── examples.md (具体例)
```

### code-review（1087行 → ~300行×4）

```
code-review/
├── SKILL.md (概要 + ナビゲーション、~300行)
├── ai-review-handling.md (AIレビュー対応)
├── resolve-patterns.md (Resolveパターン)
└── false-positives.md (誤検知パターン)
```
