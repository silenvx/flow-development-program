# 新Lintルール追加チェックリスト

新しいlintルールを追加する際の確認事項。

**背景**: HOOK004/HOOK005追加時（誤検知パターンの事前検討が不十分だったケース）でAIレビューにより「docstring内の `/tmp` を誤検知しないか」「文字列内の `#` をコメントと誤認しないか」といったエッジケースを指摘された。結果的に問題なかったが、実装前に検討できていればより良かった。

## 実装前

- [ ] 検出すべきパターンを明確化
  - 具体的なコード例を列挙
  - なぜ問題なのかを説明できる
- [ ] 誤検知しうるパターンを列挙
  - 文字列リテラル内（`"/tmp/file"` など）
  - コメント内（`# /tmp is used for...` など）
  - docstring内（`"""Uses /tmp for caching"""` など）
  - f-string内（`f"/tmp/{name}"` など）
  - 型アノテーション内（`Literal["/tmp"]` など）
  - デコレータ引数内
  - 正規表現パターン内
- [ ] 既存コードベースへの影響をドライランで確認
  ```bash
  # 例: 新ルールをサマリーモードで実行（詳細エラーなし）
  python3 .claude/scripts/hook_lint.py --check-only
  ```

## テスト

- [ ] 検出すべきケースのテスト
  - 明確な違反パターン
  - 境界ケース
- [ ] 誤検知しないケースのテスト（重要）
  - 文字列リテラル内のパターン
  - コメント/docstring内のパターン
  - 類似だが問題ないパターン
- [ ] エッジケースのテスト
  - 複数行にまたがるケース
  - ネストした構造
  - エスケープ文字を含むケース

## 実装時の注意

- ASTベースの解析を優先（文字列マッチングより精度が高い）
- 誤検知が発生したら即座にテストケースとして追加
- エラーメッセージは修正方法を示すこと

## レビュー前

- [ ] `hook_lint.py` のテストカバレッジを確認
  ```bash
  python3 -m pytest .claude/scripts/tests/test_hook_lint.py -v
  ```
- [ ] 誤検知テストが十分に含まれているか確認

## 関連

- Issue #1193: AIレビュー指摘の将来改善
- PR #1189: Issue #1183の実装で発見された教訓
